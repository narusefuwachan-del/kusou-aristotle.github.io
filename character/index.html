<!doctype html>

<html lang="ja">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Character | 空想世界アリストテレス</title>
  <link rel="icon" href="/favicon.png">

  <!-- ===== Kazuki Reiwa Light (LOCAL) ===== -->
  <style>
    @font-face{
      font-family: "Kazuki Reiwa";
      src: url("/fonts/KazukiReiwa-Light.ttf") format("truetype");
      font-weight: 300;
      font-style: normal;
      font-display: swap;
    }
  </style>

  <style>
    *{ box-sizing:border-box; }
    html,body{ margin:0; padding:0; }

    body{
      font-family:"Kazuki Reiwa", serif;
      background:#0b0b0f;
      color:#fff;
      overflow-x:hidden;
    }

    /* ===== header ===== */
    .header{
      position:sticky;
      top:0;
      z-index:60;
      display:flex;
      justify-content:space-between;
      align-items:center;
      padding:12px 16px;
      background:rgba(0,0,0,.4);
      backdrop-filter:blur(8px);
      border-bottom:1px solid rgba(255,255,255,.08);
    }
    .site-title{
      font-size:18px;
      letter-spacing:.08em;
      color:#fff;
      text-decoration:none;
    }
    .menu-btn{
      font-size:22px;
      background:none;
      border:none;
      color:#fff;
      cursor:pointer;
    }

    /* ===== hamburger ===== */
    .overlay{
      position:fixed;
      inset:0;
      background:rgba(0,0,0,.55);
      opacity:0;
      pointer-events:none;
      transition:.25s;
      z-index:1000;
    }
    .overlay.open{ opacity:1; pointer-events:auto; }

    nav.menu{
      position:fixed;
      top:0;
      right:0;
      width:320px;
      max-width:80vw;
      height:100vh;
      background:rgba(0,0,0,.88);
      backdrop-filter:blur(10px);
      transform:translateX(100%);
      transition:.25s;
      z-index:1001;
      padding:20px 16px;
    }
    nav.menu.open{ transform:translateX(0); }

    .menu-top{
      display:flex;
      justify-content:space-between;
      align-items:center;
      border-bottom:1px solid rgba(255,255,255,.15);
      padding-bottom:10px;
      margin-bottom:10px;
    }
    .menu-title{ letter-spacing:.2em; }
    .close-btn{
      font-size:20px;
      background:none;
      border:none;
      color:#fff;
      cursor:pointer;
    }
    nav.menu a{
      display:block;
      padding:14px 6px;
      color:#fff;
      text-decoration:none;
      letter-spacing:.14em;
      border-bottom:1px solid rgba(255,255,255,.1);
    }

    /* ===== page (LIST) ===== */
    .container{
      max-width:1100px;
      margin:0 auto;
      padding:56px 16px 80px;
      text-align:center;
    }

    .title-ruby{
      font-size:13px;
      letter-spacing:.35em;
      opacity:.55;
      margin-bottom:6px;
    }
    .page-title{
      font-size:40px;
      letter-spacing:.16em;
      margin:0;
      font-weight:300;
    }

    /* ===== switch ===== */
    .switch{
      display:flex;
      margin:44px auto 36px;
      max-width:360px;
      border:1px solid rgba(255,255,255,.25);
    }
    .switch button{
      flex:1;
      padding:14px 0;
      background:none;
      border:none;
      color:#fff;
      font-family:inherit;
      letter-spacing:.22em;
      cursor:pointer;
    }
    .switch button.active{
      background:#1aa5a5;
      color:#000;
    }

    /* ===== grid ===== */
    .grid{
      display:grid;
      grid-template-columns:repeat(2,1fr);
      gap:12px;
    }
    @media(min-width:700px){
      .grid{ grid-template-columns:repeat(4,1fr); }
    }
    .card{
      position:relative;
      aspect-ratio:3/2;
      background:rgba(255,255,255,.04);
      border:1px solid rgba(255,255,255,.25);
      overflow:hidden;
      cursor:pointer;
      user-select:none;
      -webkit-tap-highlight-color: transparent;
      transition: transform .12s ease, border-color .12s ease, background .12s ease;
    }
    .card:hover{
      border-color: rgba(255,255,255,.40);
      background: rgba(255,255,255,.06);
    }
    .card:active{ transform: scale(.99); }
    .card img{
      width:100%;
      height:100%;
      object-fit:cover;
      display:block;
    }
    .num{
      position:absolute;
      right:12px;
      bottom:8px;
      font-size:32px;
      opacity:.85;
      letter-spacing:.1em;
      pointer-events:none;
    }

    /* ===== footer ===== */
    footer{
      padding:48px 16px 56px;
      text-align:center;
      background:rgba(0,0,0,.35);
      border-top:1px solid rgba(255,255,255,.1);
    }
    .footer-logo{
      width:min(260px,70vw);
      margin:0 auto 18px;
      display:block;
    }
    .footer-note{
      font-size:12px;
      opacity:.6;
      line-height:1.7;
      letter-spacing:.06em;
    }

    /* =========================================================
       Password Overlay  ✅消さない
    ========================================================= */
    .lockOverlay{
      position:fixed;
      inset:0;
      background: rgba(0,0,0,.74);
      opacity:0;
      pointer-events:none;
      transition: opacity .22s ease;
      z-index: 2000;
    }
    .lockOverlay.open{ opacity:1; pointer-events:auto; }

    .lockBox{
      position:fixed;
      inset:0;
      display:grid;
      place-items:center;
      z-index: 2001;
      opacity:0;
      pointer-events:none;
      transition: opacity .22s ease;
    }
    .lockBox.open{ opacity:1; pointer-events:auto; }

    .lockCard{
      width: min(92vw, 420px);
      border: 1px solid rgba(255,255,255,.16);
      background: rgba(10,10,14,.92);
      backdrop-filter: blur(10px);
      border-radius: 16px;
      padding: 18px 16px 16px;
      box-shadow: 0 20px 70px rgba(0,0,0,.55);
      text-align: left;
    }
    .lockTitle{
      font-size: 13px;
      letter-spacing: .22em;
      opacity: .75;
      margin: 0 0 10px;
    }
    .lockRow{
      display:flex;
      align-items:center;
      gap: 12px;
    }
    .lockLabel{
      font-size: 12px;
      letter-spacing: .18em;
      opacity: .65;
      min-width: 86px;
    }
    .lockField{
      flex:1;
      height: 44px;
      border-radius: 10px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      display:flex;
      align-items:center;
      padding: 0 12px;
      font-size: 18px;
      letter-spacing: .22em;
    }
    .cursor{
      width: 10px;
      height: 18px;
      margin-left: 2px;
      background: rgba(255,255,255,.8);
      animation: blink 1s steps(1,end) infinite;
      display:inline-block;
    }
    @keyframes blink{ 50%{ opacity:0; } }
    .lockStatus{
      margin-top: 12px;
      font-size: 12px;
      letter-spacing: .18em;
      opacity: .7;
    }
    .lockStatus.ok{
      color: #8fffe6;
      opacity: .95;
    }

    /* =========================================================
       Profile Page (FULLSCREEN) ✅モーダルじゃない
    ========================================================= */
    .profilePage{
      --accent:#4fbfc2;
      display:none; /* 初期は隠す */
      min-height: calc(100vh - 56px);
      padding: 14px;
      max-width: 1100px;
      margin: 0 auto;
    }
    .profilePage.open{ display:block; }

    .profileShell{
      border-radius: 18px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(10,10,14,.92);
      backdrop-filter: blur(10px);
      box-shadow: 0 24px 90px rgba(0,0,0,.55);
      overflow:hidden;

      display:flex;
      flex-direction:column;
      min-height: calc(100vh - 56px - 28px);
    }

    .profileTop{
      display:flex;
      justify-content:space-between;
      align-items:center;
      padding: 12px 14px;
      border-bottom: 1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.35);
      flex: 0 0 auto;
    }
    .profileTitle{
      letter-spacing: .18em;
      font-size: 13px;
      opacity: .88;
      display:flex;
      align-items:baseline;
      gap:10px;
    }
    .profileNo{
      opacity:.75;
      letter-spacing:.22em;
    }
    .profileClose{
      font-size: 20px;
      background:none;
      border:none;
      color:#fff;
      cursor:pointer;
      padding: 6px 10px;
      border-radius: 10px;
    }

    .profileBody{
      overflow:auto;
      -webkit-overflow-scrolling: touch;
      padding: 14px;
      flex: 1 1 auto;
      min-height: 0;
    }

    /* ========== 上段：君が作る画像枠 ========== */
    .hero{
      position:relative;
      border-radius: 14px;
      overflow:hidden;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.03);
    }
    .hero img{
      width:100%;
      height:auto;
      display:block;
    }

    .heroFade{
      position:absolute;
      left:0; right:0; bottom:0;
      height: 18%;
      pointer-events:none;
      background: linear-gradient(
        to bottom,
        rgba(10,10,14,0) 0%,
        rgba(10,10,14,.55) 55%,
        rgba(10,10,14,.92) 85%,
        rgba(10,10,14,1) 100%
      );
    }

    .heroTools{
      position:absolute;
      top:10px;
      right:10px;
      display:flex;
      gap:8px;
      z-index:2;
    }
    .s2btn{
      width: 56px;
      height: 56px;
      border-radius: 999px;
      border: none;
      background: var(--accent);
      color: #000;
      font-family: inherit;
      font-weight: 300;
      letter-spacing: .14em;
      font-size: 14px;
      line-height: 1;
      cursor: pointer;
      display:grid;
      place-items:center;
      -webkit-tap-highlight-color: transparent;
      box-shadow:
        0 0 0 1px rgba(255,255,255,.08) inset,
        0 18px 50px rgba(0,0,0,.45);
      transition: transform .12s ease, filter .12s ease;
      user-select:none;
    }
    .s2btn:hover{ filter: brightness(1.05) saturate(1.05); }
    .s2btn:active{ transform: scale(.98); }

    .glitchLayer{
      position:absolute;
      inset:0;
      pointer-events:none;
      opacity:0;
      mix-blend-mode: screen;
      background:
        repeating-linear-gradient(
          0deg,
          rgba(255,255,255,.08) 0px,
          rgba(255,255,255,.08) 1px,
          rgba(0,0,0,0) 2px,
          rgba(0,0,0,0) 4px
        );
      filter: blur(0.6px);
      transform: translateZ(0);
    }
    .hero.glitching .glitchLayer{
      animation: glitch 420ms steps(2,end) 1;
      opacity: .9;
    }
    .hero.glitching img{
      animation: blurpop 420ms ease 1;
    }
    @keyframes glitch{
      0%{ transform: translate(0,0); }
      20%{ transform: translate(-3px, 1px); }
      40%{ transform: translate(2px, -1px); }
      60%{ transform: translate(-2px, -1px); }
      80%{ transform: translate(3px, 1px); }
      100%{ transform: translate(0,0); }
    }
    @keyframes blurpop{
      0%{ filter: blur(0px) saturate(1); }
      30%{ filter: blur(2.2px) saturate(1.35); }
      100%{ filter: blur(0px) saturate(1); }
    }

    /* ========== 下段：説明UI（テーマカラー反映） ========== */
    .info{
      margin-top: 12px;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.02);
      overflow:hidden;
    }
    .infoHeader{
      padding: 12px 12px 10px;
      border-bottom: 1px solid rgba(255,255,255,.08);
      background: rgba(0,0,0,.22);
    }

    .nameImg{
      width: min(320px, 78vw);
      height:auto;
      display:block;
      margin: 2px 0 2px;
      filter: drop-shadow(0 10px 30px rgba(0,0,0,.35));
    }

    .accentLine{
      height: 1px;
      background: rgba(255,255,255,.08);
      box-shadow: 0 0 0 1px rgba(0,0,0,.15) inset;
      position: relative;
    }
    .accentLine::after{
      content:"";
      position:absolute;
      left:0; right:0; top:0; bottom:0;
      background: linear-gradient(90deg,
        color-mix(in srgb, var(--accent) 78%, transparent),
        transparent 70%);
      opacity:.95;
      pointer-events:none;
    }

    .infoBody{
      padding: 12px 12px 14px;
      text-align:left;
      line-height:1.85;
      letter-spacing:.05em;
      font-size: 14px;
    }

    .desc{
      color: color-mix(in srgb, var(--accent) 92%, white 8%);
      opacity: .95;
    }

    .meta{
      margin-top: 10px;
      color: rgba(255,255,255,.78);
      font-size: 12px;
      line-height:1.8;
    }

    .navRow{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:6px;
      padding: 10px 10px 12px;
      border-top: 1px solid rgba(255,255,255,.08);
      background: rgba(0,0,0,.20);
      flex-wrap: nowrap;
      min-width: 0;
      position: sticky;
      bottom: 0;
      backdrop-filter: blur(10px);
    }
    .navSide{
      display:flex;
      gap:6px;
      align-items:center;
      min-width: 0;
      flex: 0 0 auto;
    }

    .navBtn{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      cursor:pointer;
      user-select:none;
      -webkit-tap-highlight-color: transparent;

      width: 44px;
      height: 44px;
      border-radius: 999px;

      border: none;
      background: rgba(255,255,255,.06);
      color: color-mix(in srgb, var(--accent) 88%, white 12%);
      font-size: 16px;

      box-shadow:
        0 0 0 1px rgba(255,255,255,.08) inset,
        0 10px 30px rgba(0,0,0,.35);
      transition: transform .12s ease, background .12s ease;
    }
    .navBtn:hover{ background: rgba(255,255,255,.10); }
    .navBtn:active{ transform: scale(.98); }
    .navBtn[aria-disabled="true"]{
      opacity:.25;
      pointer-events:none;
    }

    .backBtn{
      cursor:pointer;
      user-select:none;
      -webkit-tap-highlight-color: transparent;

      display:flex;
      align-items:center;
      justify-content:center;
      gap:.06em;
      min-width: 0;

      padding: 12px 10px;
      border-radius: 999px;

      border: none;
      background: rgba(255,255,255,.05);
      color: color-mix(in srgb, var(--accent) 92%, white 8%);

      font-size: 15px;
      white-space: nowrap;
      flex: 1 1 auto;
      max-width: 100%;

      box-shadow:
        0 0 0 1px rgba(255,255,255,.08) inset,
        0 10px 30px rgba(0,0,0,.30);
      transition: transform .12s ease, background .12s ease;
    }
    .backBtn:hover{ background: rgba(255,255,255,.08); }
    .backBtn:active{ transform: scale(.98); }

    .backBtn .text{ letter-spacing:.14em; }
    .backBtn .arrow{ letter-spacing:0; margin:0; }

    @media (max-width: 360px){
      .backBtn{
        font-size: 13px;
        padding: 11px 8px;
      }
      .navBtn{ width: 42px; height: 42px; }
      .navRow{ gap:4px; }
      .navSide{ gap:4px; }
    }

    @media (prefers-reduced-motion: reduce){
      .lockOverlay,.lockBox{ transition:none; }
      .cursor{ animation:none; }
      .hero.glitching .glitchLayer, .hero.glitching img{ animation:none; }
    }
  </style>
</head>

<body>

<header class="header">
  <a href="/" class="site-title">空想世界アリストテレス</a>
  <button class="menu-btn" id="menuBtn">☰</button>
</header>

<div class="overlay" id="overlay"></div>
<nav class="menu" id="menu" aria-hidden="true">
  <div class="menu-top">
    <div class="menu-title">MENU</div>
    <button class="close-btn" id="closeBtn" aria-label="閉じる">✕</button>
  </div>
  <a href="/">Home</a>
  <a href="/character/">Character</a>
  <a href="/story/">Story</a>
  <a href="/guide/">Guide</a>
</nav>

<!-- ============== LIST PAGE ============== -->
<main class="container" id="listPage">
  <div class="title-ruby">character</div>
  <h1 class="page-title">空想世界 名簿記録</h1>

  <div class="switch">
    <button id="btnMain" class="active">MAIN</button>
    <button id="btnSub">SUB</button>
  </div>

  <div id="grid" class="grid"></div>
</main>

<footer id="listFooter">
  <img src="/images/logo.png" class="footer-logo" alt="">
  <div class="footer-note">
    © 空想世界アリストテレス<br>
    当サイトの内容・文章・画像等の無断使用を固く禁じます。
  </div>
</footer>

<!-- ============== PROFILE PAGE (FULLSCREEN) ============== -->
<section class="profilePage" id="profilePage" aria-hidden="true">
  <div class="profileShell" id="profileInner" role="region" aria-label="プロフィール">
    <div class="profileTop">
      <div class="profileTitle">
        <span id="profileTitle">PROFILE</span>
        <span class="profileNo" id="profileNo">01</span>
      </div>
      <button class="profileClose" id="profileClose" aria-label="一覧に戻る">✕</button>
    </div>

    <div class="profileBody">
      <!-- 上段：君が作るイラスト（S1/S2切り替え） -->
      <div class="hero" id="hero">
        <div class="heroTools">
          <button class="s2btn" id="btnS2" type="button" aria-label="S2に切り替え">S2</button>
        </div>
        <div class="glitchLayer" aria-hidden="true"></div>
        <img id="heroImg" src="" alt="">
        <div class="heroFade" aria-hidden="true"></div>
      </div>

      <!-- 下段：説明＋線＋ナビ -->
      <div class="info">
        <div class="infoHeader">
          <img id="nameImg" class="nameImg" src="" alt="">
        </div>

        <div class="accentLine" aria-hidden="true"></div>

        <div class="infoBody">
          <div class="desc" id="descText">説明文（ここにテキストが入る）</div>
          <div class="meta" id="metaText">※ここは補足欄（年齢/要素/属性など）を後から増やせるよ</div>
        </div>

        <div class="navRow">
          <div class="navSide">
            <button class="navBtn" id="prevBtn" type="button" aria-label="前へ">&lt;</button>
          </div>

          <button class="backBtn" id="backBtn" type="button" aria-label="一覧に戻る">
            <span class="arrow left">&lt;</span>
            <span class="text">Back to list</span>
            <span class="arrow right">&gt;</span>
          </button>

          <div class="navSide" style="justify-content:flex-end;">
            <button class="navBtn" id="nextBtn" type="button" aria-label="次へ">&gt;</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- ================= Password Overlay ✅消さない ================= -->
<div class="lockOverlay" id="lockOverlay" aria-hidden="true"></div>
<section class="lockBox" id="lockBox" aria-hidden="true">
  <div class="lockCard" role="dialog" aria-modal="true" aria-label="パスワード認証">
    <div class="lockTitle">ACCESS AUTH</div>
    <div class="lockRow">
      <div class="lockLabel">PASSWORD</div>
      <div class="lockField">
        <span id="pwText"></span><span class="cursor" aria-hidden="true"></span>
      </div>
    </div>
    <div class="lockStatus" id="pwStatus">…</div>
  </div>
</section>

<script>
  const grid = document.getElementById("grid");
  const btnMain = document.getElementById("btnMain");
  const btnSub = document.getElementById("btnSub");

  const mainImages = Array.from({length:14},(_,i)=>
    `/images/character/main${String(i+1).padStart(2,"0")}.webp`
  );

  // ====== キャラ別：アクセントカラー ======
  const accents = [
    "#4fbfc2", // 01 翠
    "#c24f4f", // 02 零
    "#e0a038", // 03
    "#80a87d", // 04
    "#7d92a8", // 05
    "#941c34", // 06
    "#50e65d", // 07
    "#05079c", // 08
    "#6cbecc", // 09
    "#e83a83", // 10
    "#499151", // 11
    "#e0e0e0", // 12
    "#ae76db", // 13
    "#c9a824"  // 14
  ];

  // ====== パスワード ✅残す ======
  const passcodes = [
    "1023","1124","1203","0312","0211","0224","0528","0528","0718","1228","0114","0521","0807","0122"
  ];

  // ====== 上段画像（S1/S2） ======
  const heroS1 = Array.from({length:14},(_,i)=>
    `/images/profile/hero/${String(i+1).padStart(2,"0")}_s1.webp`
  );
  const heroS2 = Array.from({length:14},(_,i)=>
    `/images/profile/hero/${String(i+1).padStart(2,"0")}_s2.webp`
  );

  // ====== 名前画像 ======
  const nameImgs = Array.from({length:14},(_,i)=>
    `/images/profile/name/${String(i+1).padStart(2,"0")}.png`
  );

// ====== 説明文 ======
const descs = [
`本作の主人公。
以前まで度重なる不幸に
見舞われ闇を抱えていたがアンジェラにおまじないをかけられ、本来の明るさを取り戻すように。
取り戻してからは克服したのか、メンタルが図太くなりいい意味でも悪い意味でもちょっとしたことでは折れなくなった。
アンジェラに助けられてから「自分も私みたいな人を救いたい」と思い、悩んでいる人々の想いを解決したいと日々行動している。`,

`翠が抱えていた負の感情だけを受け継いで生まれたクローン体。
希死念慮を持っており、自分を生まれさせた翠を恨んでいるが、
翠に「絶対に生きてる方が楽しいって思わせてあげる！」と言われ、渋々それに付き合っている。`,

`水ヶ丘高校に通う女子高校生。
天使である事によって周りから迫害を受け続けて来たが、同じクラスの羽璃に助けられる。
そこから羽璃とは親友のような関係性になるが、季依恋は羽璃に親友とは別の想いを抱えている。`,

`水ヶ丘高校に通う心優しい女子高校生。
神の子であるが故に周りからおだてられており、「もっとちゃんと自分を見て欲しい」と思っている。
陸上部のマネージャーをしており、陸上部の1つ上の先輩である夕霧に片思い中。`,

`水ヶ丘高校に通う男子高校生。
常にうるさくふざけている為、歩く救急車サイレンと呼ばれている。
陸上部に入っており、練習中は見違えたように真剣になる。
おちゃらけてはいるが、やる時はやる男。`,

`季依恋の姉。
家庭的な事情で高校に通えておらず、せめてでも季依恋に高校へ行かせてあげたいと思っている為、
日々バイトをして季依恋の学費と生活費を稼いでいる。
親に捨てられてからは季依恋に対して過保護な面も見られるが、誰よりも季依恋を大事に思っている。`,

`聖愛女学院高等学校に通う女子高校生。
親の為に成績上位を取り、常に優等生として生活している。
親からの期待に応える日々も、いつしか限界を迎える。
そんな時に、幼馴染である優芽とバッタリ出会い…？`,

`聖愛女学院高等学校に通う無口な女子高校生。
ボーイッシュなスタイルを好み、服装をメンズに合わせることが多い。
その為周りから非常にモテている。
兄との関係が悪く、5年ぶりに兄が帰省してきた日にとある事件が起こる。`,

`世花財閥のお嬢様。
そして今作一番のクズである。
違法BARで接客をしており、色んな女性と関係を持っている。
浮気を悪い事だと思っておらず、倫理観が著しく欠けている史上最悪の女。`,

`聖愛女学院高等学校に通うアイドル的大人気女子高校生。
演劇部に所属しており、演技が大好きでこの先もずっと演劇で生きていきたいと思っている。
明るく交友関係も良好で、幸せな高校生活を送っている。
…はずだったのだが、中学最後の全国大会で最悪な出来事が起こってしまう。`,

`怜冬と同じ違法BARで働く大学生。
諸事情から白花と同棲している。
将来的に警察になりたいと強く思っており、仕事と両立しながら資格の勉強もこなしている。
怜冬とは高校時代の同級生だが、とある事件をきっかけに現在も非常に仲が悪い。`,

`天空世界にいたあきはの遣いの天使。
とある復讐を果たすために地上へ降りてきた。
それと同時に、自殺をしようとしていた翠を助けた張本人でもある。
しかし、アンジェラには違う目的があるようで…。`,

`あきはによって創られたお助けロボット。
ロボットとは思えない程人間に近い容姿や動きをする。
自我を持ち、自分自身で自由に行動できるが、最近は少し体の調子が悪いようで…。`,

`この世界を創った創造主。
…らしい。自称神。
翠が親に捨てられ路頭に迷っていた時に保護し、共に生活している。
ポンコツ気味で明るく騒がしいが、誰かが危険な行動をしようとすると凄い剣幕で阻止する。`
];

// ====== ステータス ======
const metas = [
`年齢：17歳 / 性別：女 / 種族：人間
身長：156cm / 誕生日：10月23日`,

`年齢：17歳 / 性別：女 / 種族：人間
身長：156cm / 誕生日：11月24日`,

`年齢：17歳 / 性別：女 / 種族：天使
身長：153cm / 誕生日：12月3日`,

`年齢：17歳 / 性別：女 / 種族：神の子
身長：149cm / 誕生日：3月12日`,

`年齢：18歳 / 性別：男 / 種族：人間
身長：171cm / 誕生日：2月11日`,

`年齢：18歳 / 性別：女 / 種族：天使
身長：164cm / 誕生日：2月24日`,

`年齢：16歳 / 性別：女 / 種族：人間
身長：157cm / 誕生日：5月28日`,

`年齢：16歳 / 性別：女 / 種族：人間
身長：162cm / 誕生日：5月28日`,

`年齢：21歳 / 性別：女 / 種族：人間
身長：173cm / 誕生日：7月18日`,

`年齢：16歳 / 性別：女 / 種族：人間
身長：151cm / 誕生日：12月28日`,

`年齢：21歳 / 性別：女 / 種族：人間
身長：172cm / 誕生日：1月14日`,

`年齢：??歳 / 性別：男 / 種族：天使
身長：168cm / 誕生日：5月21日`,

`年齢：?? / 性別：無 / 種族：ロボット
身長：154cm / 誕生日：?月?日`,

`年齢：?? / 性別：女 / 種族：神
身長：152cm / 誕生日：?月?日`
];
  function renderMain(){
    grid.innerHTML = mainImages.map((src,i)=>`
      <div class="card" data-index="${i}" role="button" tabindex="0" aria-label="${String(i+1).padStart(2,"0")}を開く">
        <img src="${src}" alt="">
        <div class="num">${String(i+1).padStart(2,"0")}</div>
      </div>
    `).join("");
  }

  function renderSub(){
    grid.innerHTML = `
      <div style="grid-column:1/-1;opacity:.6;letter-spacing:.25em;padding:80px 0;">
        SUBは準備中です
      </div>`;
  }

  renderMain();

  btnMain.onclick=()=>{
    btnMain.classList.add("active");
    btnSub.classList.remove("active");
    renderMain();
  };
  btnSub.onclick=()=>{
    btnSub.classList.add("active");
    btnMain.classList.remove("active");
    renderSub();
  };

  /* ===== hamburger ===== */
  const menuBtn=document.getElementById("menuBtn");
  const closeBtn=document.getElementById("closeBtn");
  const menu=document.getElementById("menu");
  const overlay=document.getElementById("overlay");

  menuBtn.onclick=()=>{
    menu.classList.add("open");
    overlay.classList.add("open");
    menu.setAttribute("aria-hidden","false");
  };
  closeBtn.onclick=overlay.onclick=()=>{
    menu.classList.remove("open");
    overlay.classList.remove("open");
    menu.setAttribute("aria-hidden","true");
  };

  /* =========================================================
     Password -> Open Profile Page (FULLSCREEN)
  ========================================================= */
  const lockOverlay = document.getElementById("lockOverlay");
  const lockBox = document.getElementById("lockBox");
  const pwText = document.getElementById("pwText");
  const pwStatus = document.getElementById("pwStatus");

  const listPage = document.getElementById("listPage");
  const listFooter = document.getElementById("listFooter");

  const profilePage = document.getElementById("profilePage");
  const profileInner = document.getElementById("profileInner");
  const profileClose = document.getElementById("profileClose");
  const profileTitle = document.getElementById("profileTitle");
  const profileNo = document.getElementById("profileNo");

  const hero = document.getElementById("hero");
  const heroImg = document.getElementById("heroImg");
  const btnS2 = document.getElementById("btnS2");

  const nameImg = document.getElementById("nameImg");
  const descText = document.getElementById("descText");
  const metaText = document.getElementById("metaText");

  const backBtn = document.getElementById("backBtn");
  const prevBtn = document.getElementById("prevBtn");
  const nextBtn = document.getElementById("nextBtn");

  const profileBody = document.querySelector("#profilePage .profileBody");

  let animRunning = false;
  let currentIndex = 0;
  let currentSeason = "s1"; // s1 / s2

  const sleep = (ms) => new Promise(r => setTimeout(r, ms));

  const openLock = () => {
    lockOverlay.classList.add("open");
    lockBox.classList.add("open");
    lockOverlay.setAttribute("aria-hidden","false");
    lockBox.setAttribute("aria-hidden","false");
    document.body.style.overflow = "hidden";   // ✅ パスワード中は背景スクロール止める
  };

  const closeLock = () => {
    lockOverlay.classList.remove("open");
    lockBox.classList.remove("open");
    lockOverlay.setAttribute("aria-hidden","true");
    lockBox.setAttribute("aria-hidden","true");
    document.body.style.overflow = "";         // ✅ 終わったら元に戻す（ここが超重要）
  };

  function showProfilePage(){
    // 一覧を隠してプロフィールを出す
    listPage.style.display = "none";
    listFooter.style.display = "none";
    profilePage.classList.add("open");
    profilePage.setAttribute("aria-hidden","false");
    // ❌ ここでは overflow を触らない（スクロール殺さない）
    window.scrollTo({ top: 0, behavior: "instant" });
  }

  function showListPage(){
    profilePage.classList.remove("open");
    profilePage.setAttribute("aria-hidden","true");
    listPage.style.display = "";
    listFooter.style.display = "";
    document.body.style.overflow = "";

    // キャラ一覧の先頭へ戻す
    const y = listPage ? listPage.offsetTop : 0;
    window.scrollTo({ top: y, behavior: "instant" });
  }

  function setNavState(idx){
    prevBtn.setAttribute("aria-disabled", idx === 0 ? "true" : "false");
    nextBtn.setAttribute("aria-disabled", idx === 13 ? "true" : "false");
    prevBtn.style.visibility = (idx === 0) ? "hidden" : "visible";
    nextBtn.style.visibility = (idx === 13) ? "hidden" : "visible";
  }

  function idealTextColor(hex){
    const h = hex.replace("#","").trim();
    if(h.length !== 6) return "#fff";
    const r = parseInt(h.slice(0,2),16);
    const g = parseInt(h.slice(2,4),16);
    const b = parseInt(h.slice(4,6),16);
    const y = (r*299 + g*587 + b*114) / 1000;
    return (y >= 170) ? "#000" : "#fff";
  }

  function applyAccent(idx){
    const a = accents[idx] || "#4fbfc2";
    profileInner.style.setProperty("--accent", a);
    profilePage.style.setProperty("--accent", a);
    btnS2.style.color = idealTextColor(a);
  }

  function loadCharacter(idx, season="s1", withGlitch=false){
    currentIndex = idx;
    currentSeason = season;

    const no = String(idx+1).padStart(2,"0");
    profileTitle.textContent = "PROFILE";
    profileNo.textContent = no;

    applyAccent(idx);
    setNavState(idx);

    const src = (season === "s2") ? heroS2[idx] : heroS1[idx];

    if(withGlitch){
      hero.classList.add("glitching");
      heroImg.src = src;
      setTimeout(()=> hero.classList.remove("glitching"), 460);
    }else{
      heroImg.src = src;
    }
    heroImg.alt = `Hero ${no} ${season.toUpperCase()}`;

    nameImg.src = nameImgs[idx];
    nameImg.alt = `Name ${no}`;

    descText.textContent = descs[idx] || "";
    metaText.textContent = metas[idx] || "";

    // プロフィール内部スクロールを先頭へ
    if(profileBody) profileBody.scrollTo({ top: 0, behavior: "instant" });
  }

  async function playPasswordAndOpen(idx){
    if(animRunning) return;
    animRunning = true;

    pwText.textContent = "";
    pwStatus.className = "lockStatus";
    pwStatus.textContent = "…";

    openLock();
    await sleep(220);

    const code = passcodes[idx] || "0000";
    for(let i=0;i<code.length;i++){
      pwText.textContent += code[i];
      await sleep(120);
    }

    await sleep(160);
    pwStatus.textContent = "COMPLETE";
    pwStatus.classList.add("ok");

    await sleep(300);
    closeLock();

    await sleep(140);
    showProfilePage();
    loadCharacter(idx, "s1", false);

    animRunning = false;
  }

  // MAINカードクリックで起動
  function onCardActivate(e){
    const card = e.target.closest(".card");
    if(!card) return;
    const idx = Number(card.dataset.index);
    playPasswordAndOpen(idx);
  }
  grid.addEventListener("click", onCardActivate);
  grid.addEventListener("keydown", (e)=>{
    if(e.key !== "Enter") return;
    onCardActivate(e);
  });

  // 閉じる（× / Back）
  profileClose.addEventListener("click", showListPage);
  backBtn.addEventListener("click", showListPage);

  // ESC
  window.addEventListener("keydown", (e)=>{
    if(e.key === "Escape"){
      if(profilePage.classList.contains("open")) showListPage();
    }
  });

  // 前/次（S1固定で移動）
  prevBtn.addEventListener("click", ()=>{
    if(currentIndex <= 0) return;
    loadCharacter(currentIndex-1, "s1", false);
  });
  nextBtn.addEventListener("click", ()=>{
    if(currentIndex >= 13) return;
    loadCharacter(currentIndex+1, "s1", false);
  });

  // S2切り替え（押すたびトグル）
  btnS2.addEventListener("click", ()=>{
    const nextSeason = (currentSeason === "s1") ? "s2" : "s1";
    loadCharacter(currentIndex, nextSeason, true);
  });
</script>

</body>
</html>
